---
title: "Nonprofit"
author: "Trey Roark"
format: 
  html:
    toc: true
    toc-title: "Table of Contents"
    embed-resources: true
    warnings: false
    code-fold: true
execute:
  echo: false
---

# Overview

Through analysis already done by Trey Roark and Amelia Baier with the data at the IRS, we'll create a summary of what we believe to be the most important metrics and statistics of interest that we'd like to include in our dashboard. Additionally, we'll visualize these metrics and expand upon how we best believe they can be used to help our use cases.  

This will include both the data itself, as well as different ways to visualize a lot of these metrics, so our dashboard will contain a nice pipeline that will end up being easy to use.

For more information on the data and it's preprocessing, please look here: <https://theundivideproject.github.io/Philanthropic-Giving-Analysis.github.io/>


```{python}
# Libraries for data manipulation
import pandas as pd
import numpy as np

# Libraries for data vis
import matplotlib.pyplot as plt
import seaborn as sns
import plotly.express as px
import plotly.io as pio

# Libraries for quarto rending
from IPython.display import Markdown,display
from tabulate import tabulate
import plotly.io as pio

# Remove warnings
import warnings
warnings.filterwarnings("ignore", category=UserWarning)

# Read in data
df_reg_giv_irs_eo1 = pd.read_csv('data/Regional Giving Data IRS eo1.csv')

# Standardize col names
df_reg_giv_irs_eo1.columns = [x.lower() for x in df_reg_giv_irs_eo1.columns]

# Replace zeros with NaN for appropriate columns
df_reg_giv_irs_eo1['ruling'] = df_reg_giv_irs_eo1['ruling'].replace(0, np.nan)

# Replace NaN with appropriate values accordingly
df_reg_giv_irs_eo1['ntee_cd'] = df_reg_giv_irs_eo1['ntee_cd'].fillna('Z') # Z stands for unknown according to data documentation.

# Convert columns to appropriate data types
date_cols = ['ruling','tax_period']
for col in date_cols:
    df_reg_giv_irs_eo1[col] = df_reg_giv_irs_eo1[col].astype(str).str.replace(r'\.0$', '', regex=True)
    df_reg_giv_irs_eo1[col] = pd.to_datetime(df_reg_giv_irs_eo1[col], format='%Y%m', errors='coerce')
```


# EOMBF Findings

Looking at the Exempt Organizations Business Master File (EO BMF), which is pulled from the Internal Revenue Service's Business Master File, provides some features that can be used for a detailed analysis of philanthropic giving, particular within the environmental and social justice sectors. 

Right now, we're just looking specifically at the Northeast (inclusive of Connecticut, Maine, Massachusetts, New Hampshire, New Jersey, New York, Rhode Island, Vermont). This data can be found here <https://www.irs.gov/charities-non-profits/exempt-organizations-business-master-file-extract-eo-bmf>





